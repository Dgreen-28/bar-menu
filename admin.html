<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin Dashboard</title>

<style>
    body {
        font-family: Arial;
        background: #ece2c6;
        padding: 20px;
    }

    #login-box {
        text-align: center;
        margin-top: 80px;
    }

    #dashboard {
        display: none;
    }

    .order {
        background: #fff8e6;
        padding: 15px;
        margin: 10px 0;
        border: 2px solid #8a6d3b;
        border-radius: 6px;
    }

    button {
        margin-top: 10px;
        padding: 8px 12px;
        font-size: 16px;
    }

    h2 {
        margin-top: 50px;
    }

    #deleteAllBtn {
        background: #c0392b;
        color: white;
        padding: 10px 16px;
        font-size: 18px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-bottom: 20px;
    }

    #deleteAllBtn:hover {
        background: #e74c3c;
    }
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
    getFirestore,
    collection,
    query,
    orderBy,
    onSnapshot,
    doc,
    deleteDoc,
    getDocs
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDhfb6fCqWlMbLjAQA3byGpelIyGlEjL7E",
  authDomain: "bar-menu-76485.firebaseapp.com",
  projectId: "bar-menu-76485",
  storageBucket: "bar-menu-76485.firebasestorage.app",
  messagingSenderId: "1018082681996",
  appId: "1:1018082681996:web:caf04111d8a9ba155ec7a9",
  measurementId: "G-GEVDYJ3WBT"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.checkPassword = function () {
    const input = document.getElementById("pass").value;
    if (input === "3413") {
        document.getElementById("login-box").style.display = "none";
        document.getElementById("dashboard").style.display = "block";
        loadOrders();
    } else {
        alert("Incorrect password.");
    }
};

function loadOrders() {
    const q = query(collection(db, "drinks"), orderBy("timestamp", "asc"));
    const ordersDiv = document.getElementById("orders");

    onSnapshot(q, (snapshot) => {
        ordersDiv.innerHTML = "";

        snapshot.forEach((docSnap) => {
            const data = docSnap.data();

            const div = document.createElement("div");
            div.className = "order";

            div.innerHTML = `
                <h3>${data.name}</h3>
                <p><b>Orderer:</b> ${data.orderer}</p>
                <button onclick="removeOrder('${docSnap.id}')">Delete</button>
            `;

            ordersDiv.appendChild(div);
        });
    });
}

window.removeOrder = async function (id) {
    await deleteDoc(doc(db, "drinks", id));
};

window.deleteAll = async function () {
    const confirmDelete = confirm("Are you sure you want to delete ALL drink orders?");
    if (!confirmDelete) return;

    const snapshot = await getDocs(collection(db, "drinks"));
    snapshot.forEach(async (docSnap) => {
        await deleteDoc(doc(db, "drinks", docSnap.id));
    });
};
</script>

</head>
<body>

<div id="login-box">
    <h1>Admin Login</h1>
    <input id="pass" type="password" placeholder="Enter Admin Code">
    <br><br>
    <button onclick="checkPassword()">Enter</button>
</div>

<div id="dashboard">
    <h1>Drink Order Queue</h1>

    <button id="deleteAllBtn" onclick="deleteAll()">Delete All Orders</button>

    <div id="orders"></div>
</div>

</body>
</html>
